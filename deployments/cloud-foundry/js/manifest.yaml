applications:
  - name: crypto-broker-js-client
    command: 'node dist/cli.js --loop 10 --profile=KAT_SHA3_512 hash "Welcome CryptoBroker"'
    disk_quota: 256M
    instances: 1
    memory: 128M
    env:
      HUSKY: 0
    buildpacks:
      - nodejs_buildpack
      - binary_buildpack
    health-check-type: process
    process_types:
      - web
    sidecars:
      - name: crypto-broker-server
        health-check-type: process
        process_types:
          - web
        command: 'CRYPTO_BROKER_PROFILES_DIR=$PWD ./cryptobroker-server'
      - name: crypto-broker-client-1
        health-check-type: process
        process_types:
          - web
        command: 'node dist/cli.js --loop 20 --profile=sign-certificate-ecdsa-sha512 sign --csr=certificates/test-csr/test-client.csr --caCert=certificates/test-ca/root-CA-ecdsa.pem --caKey=certificates/test-ca/root-CA-ecdsa-private-key.pem'
      - name: crypto-broker-client-2
        health-check-type: process
        process_types:
          - web
        command: 'node dist/cli.js --loop 30 --profile=sign-certificate-rsa-sha512 sign --csr=certificates/test-csr/test-client.csr --caCert=certificates/test-ca/root-CA-rsa.pem --caKey=certificates/test-ca/root-CA-rsa-private-key.pem'
